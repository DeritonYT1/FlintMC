buildscript {
    dependencies {
        classpath 'net.labyfy:labyfy-gradle-plugin'
    }
}

plugins {
    id 'application'
}

//apply plugin: 'net.labyfy.labyfy-gradle-plugin'

group 'net.labyfy.versioned'

sourceCompatibility = 1.8

//minecraft {
//    version "1.15.1"
//}


repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
//    compile fileTree('libraries')
    compile project(':component:launcher')

//    compile group: "net.minecraft", name: "client", version: "8b11614bea9293592a947ea8f4fd72981ea66677"

    runtimeOnly project(':component:base')
    runtimeOnly project(':component:transform:javassist')
    runtimeOnly project(':component:transform:asm')
    runtimeOnly project(':component:transform:minecraft')
    runtimeOnly project(':component:transform:minecraft-obfuscator')
    runtimeOnly project(':component:transform:hook')
    runtimeOnly project(':component:gui')
    runtimeOnly project(':component:gui:mcjfxgl')
    runtimeOnly project(':component:gui:mcjfxgl:mcjfxgl-1.15.1')
    runtimeOnly project(':component:gui:mcjfxgl:default-components')
    runtimeOnly project(':component:gui:gui-1.15.1')
    runtimeOnly project(':component:tasks')
    runtimeOnly project(':component:tasks:tasks-1.15.1')
    runtimeOnly project(':component:mapping')
    runtimeOnly project(':component:inject')
    runtimeOnly project(':component:transform:hook')
    runtimeOnly project(':component:resources')
    runtimeOnly project(':component:resources:resources-1.15.1')
    runtimeOnly project(':versioned:labyfy-1.15.1')
    runtimeOnly project(':component:packages')
    runtimeOnly project(':component:packages:packages-impl')

    minecraft project(':component:base')
    minecraft project(':component:transform:javassist')
    minecraft project(':component:transform:asm')
    minecraft project(':component:transform:minecraft')
    minecraft project(':component:transform:minecraft-obfuscator')
    minecraft project(':component:transform:hook')
    minecraft project(':component:gui')
    minecraft project(':component:gui:mcjfxgl')
    minecraft project(':component:gui:mcjfxgl:mcjfxgl-1.15.1')
    minecraft project(':component:gui:mcjfxgl:default-components')
    minecraft project(':component:gui:gui-1.15.1')
    minecraft project(':component:tasks')
    minecraft project(':component:tasks:tasks-1.15.1')
    minecraft project(':component:mapping')
    minecraft project(':component:inject')
    minecraft project(':component:transform:hook')
    minecraft project(':component:resources')
    minecraft project(':component:resources:resources-1.15.1')
    minecraft project(':component:packages')
    minecraft project(':component:packages:packages-impl')
    minecraft project(':component:transform:launcher-plugin')
    minecraft project(':component:launcher')
    minecraft project(':component:service')
    minecraft project(':component:security')
}

application {
    mainClassName "net.labyfy.component.launcher.LabyLauncher"
}

def runDir = new File(rootProject.projectDir, "run/1.15.1")
def runDirTemplate = new File(rootProject.projectDir, "run-template")
if (!runDir.exists()) {
    if (!runDir.mkdirs()) {
        throw new GradleException("Failed to create run directory: ${runDir.absolutePath}")
    } else {
        copy {
            from new File(runDirTemplate, "1.15.1")
            into runDir
        }
    }
}

run {
    workingDir runDir
    args "--uuid", "113da2d6-3c68-43c4-bee0-6f53fe8906e6",
            "--username", "DevTastisch",
            "--accessToken", "0",
            "--version", "1.15.1",
            "--assetsDir", "assets",
            "--assetIndex", "1.15",
            "--userProperties", "{}",
            "--gameDir", ".",
            "--tweakClass", "net.labyfy.component.transform.tweaker.LabyDebugTweaker"
}
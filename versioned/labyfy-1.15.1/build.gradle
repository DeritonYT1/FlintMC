buildscript {
    dependencies {
        classpath 'net.labyfy:library-downloader:1.1-SNAPSHOT'
    }
}

plugins {
    id 'application'
}

apply plugin: 'net.labyfy.library-downloader'

group 'net.labyfy.versioned'
version ''

sourceCompatibility = 1.8
minecraft.version = "1.15.1"


repositories {
    mavenCentral()
}

dependencies {
    compile fileTree('libraries')
    testCompile group: 'junit', name: 'junit', version: '4.12'
    compile project(':component:launcher')
    compile group: 'com.google.guava', name: 'guava', version: '28.2-jre'

    runtimeOnly project(':component:base')
    runtimeOnly project(':component:transform:javassist')
    runtimeOnly project(':component:transform:asm')
    runtimeOnly project(':component:transform:minecraft')
    runtimeOnly project(':component:transform:hook')
    runtimeOnly project(':component:gui')
    runtimeOnly project(':component:gui:mcjfxgl')
    runtimeOnly project(':component:gui:mcjfxgl:mcjfxgl-1.15.1')
    runtimeOnly project(':component:gui:mcjfxgl:default-components')
    runtimeOnly project(':component:gui:gui-1.15.1')
    runtimeOnly project(':component:tasks')
    runtimeOnly project(':component:tasks:tasks-1.15.1')
    runtimeOnly project(':component:mapping')
    runtimeOnly project(':component:inject')
    runtimeOnly project(':component:transform:hook')
    runtimeOnly project(':component:resources')
    runtimeOnly project(':component:resources:resources-1.15.1')
    runtimeOnly project(':versioned:labyfy-1.15.1')
    runtimeOnly project(':component:packages')
    runtimeOnly project(':component:packages:packages-impl')
}

application {
    mainClassName "net.labyfy.component.launcher.LabyLauncher"
}

def runDir = new File(rootProject.projectDir, "run")
def runDirTemplate = new File(rootProject.projectDir, "run-template")
if(!runDir.exists()) {
    if(!runDir.mkdirs()) {
        throw new GradleException("Failed to create run directory: ${runDir.absolutePath}")
    } else {
        copy {
            from new File(runDirTemplate, "1.15.1")
            into runDir
        }
    }
}

run {
    workingDir new File(runDir, "1.15.1")
    args "--uuid", "113da2d6-3c68-43c4-bee0-6f53fe8906e6",
         "--username", "DevTastisch",
         "--accessToken", "0",
         "--version", "1.15.1",
         "--assetsDir", "assets",
         "--assetIndex", "1.15",
         "--userProperties", "{}",
         "--gameDir", ".",
         "--tweakClass", "net.labyfy.component.transform.tweaker.LabyDebugTweaker"
}